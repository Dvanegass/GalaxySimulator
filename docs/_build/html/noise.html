

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Noise and Random Values &mdash; GalSim 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Wavelength-dependent Profiles" href="chromatic.html" />
    <link rel="prev" title="World Coordinate Systems" href="wcs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GalSim
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="image.html">Images and Related Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sb.html">Surface Brightness Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="wcs.html">World Coordinate Systems</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Noise and Random Values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#random-variates">Random Variates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#noise-generators">Noise Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#correlated-noise-generators">Correlated Noise Generators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chromatic.html">Wavelength-dependent Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="shear.html">Weak Lensing Shear</a></li>
<li class="toctree-l1"><a class="reference internal" href="coord.html">Angles and Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Helper Functions and Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">The Config Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsm.html">The HSM Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="des.html">The DES Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="wfirst.html">The WFIRST Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Revision History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GalSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Noise and Random Values</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/noise.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="noise-and-random-values">
<h1>Noise and Random Values<a class="headerlink" href="#noise-and-random-values" title="Permalink to this headline">¶</a></h1>
<p>An important part of generating realistic images is to add appropriate levels of noise.
When simulating objects, you may also want the actual objects being drawn to be random in some
way.  GalSim has a number of classes to help inject these kinds of randomness into your
simulations.</p>
<div class="section" id="random-variates">
<h2>Random Variates<a class="headerlink" href="#random-variates" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.BaseDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">BaseDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all the various random deviates.</p>
<p>This holds the essential random number generator that all the other classes use.</p>
<p>All deviates take an initial <code class="docutils literal notranslate"><span class="pre">seed</span></code> argument that is used to seed the underlying random number
generator.  It has three different kinds of behavior.</p>
<ol class="arabic simple">
<li><p>An integer value can be provided to explicitly seed the random number generator with a
particular value.  This is useful to have deterministic behavior.  If you seed with an
integer value, the subsequent series of “random” values will be the same each time you
run the program.</p></li>
<li><p>A seed of 0 or None means to pick some arbitrary value that will be different each time
you run the program.  Currently, this tries to get a seed from /dev/urandom if possible.
If that doesn’t work, then it creates a seed from the current time.  You can also get this
behavior by omitting the seed argument entirely.  (i.e. the default is None.)</p></li>
<li><p>Providing another BaseDeviate object as the seed will make the new Deviate share the same
underlying random number generator as the other Deviate.  So you can make one Deviate (of
any type), and seed it with a particular deterministic value.  Then if you pass that Deviate
to any other one you make, they will both be using the same RNG and the series of “random”
values will be deterministic.</p></li>
</ol>
<p>Usage:</p>
<p>There is not much you can do with something that is only known to be a BaseDeviate rather than
one of the derived classes other than construct it and change the seed, and use it as an
argument to pass to other Deviate constructors.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; rng = galsim.BaseDeviate(215324)
&gt;&gt;&gt; rng()
Traceback (most recent call last):
File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
TypeError: &#39;BaseDeviate&#39; object is not callable
&gt;&gt;&gt; ud = galsim.UniformDeviate(rng)
&gt;&gt;&gt; ud()
0.58736140513792634
&gt;&gt;&gt; ud2 = galsim.UniformDeviate(215324)
&gt;&gt;&gt; ud2()
0.58736140513792634
</pre></div>
</div>
<p>There are a few methods that are common to all BaseDeviate classes, so we describe them here.</p>
<dl class="method">
<dt>
<code class="sig-name descname">dev.seed(seed)      Set a new (integer) seed value for the underlying RNG.</code></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">dev.reset(seed)     Sever the connection to the current RNG and seed a new one (either</code></dt>
<dd><p>creating a new RNG if seed is an integer or connecting to an existing
RNG if seed is a BaseDeviate instance)</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">dev.clearCache()    Clear the internal cache of the Deviate, if there is any.</code></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">dev.duplicate()     Create a duplicate of the current Deviate, which will produce an</code></dt>
<dd><p>identical series of values as the original.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.add_generate">
<code class="sig-name descname">add_generate</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.add_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.add_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many pseudo-random values, adding them to the values of a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.clearCache">
<code class="sig-name descname">clearCache</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.clearCache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.clearCache" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the internal cache of the Deviate, if any.  This is currently only relevant for
GaussianDeviate, since it generates two values at a time, saving the second one to use for
the next output value.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.discard">
<code class="sig-name descname">discard</code><span class="sig-paren">(</span><em class="sig-param">n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.discard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Discard n values from the current sequence of pseudo-random numbers.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.duplicate">
<code class="sig-name descname">duplicate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.duplicate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.duplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a duplicate of the current Deviate object.  The subsequent series from each copy
of the Deviate will produce identical values.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">UniformDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.17100770119577646</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u2</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">duplicate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.49095047544687986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.10306670609861612</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u2</span><span class="p">()</span>
<span class="go">0.49095047544687986</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u2</span><span class="p">()</span>
<span class="go">0.10306670609861612</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u2</span><span class="p">()</span>
<span class="go">0.13129289541393518</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.13129289541393518</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.generate">
<code class="sig-name descname">generate</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many pseudo-random values, filling in the values of a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.raw">
<code class="sig-name descname">raw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.raw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the next pseudo-random number and rather than return the appropriate kind
of random deviate for this class, just return the raw integer value that would have been
used to generate this value.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the pseudo-random number generator, severing connections to any other deviates.
Providing another BaseDeviate object as the seed connects this deviate with the other
one, so they will both use the same underlying random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using None means to generate a seed from the system.
[default: None]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseDeviate.seed">
<code class="sig-name descname">seed</code><span class="sig-paren">(</span><em class="sig-param">seed=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BaseDeviate.seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseDeviate.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Seed the pseudo-random number generator with a given integer value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – An int value to be used to seed the random number generator.  Using 0
means to generate a seed from the system. [default: 0]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.UniformDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">UniformDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#UniformDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.UniformDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random number generator with uniform distribution in interval [0.,1.).</p>
<p>Successive calls to u() generate pseudo-random values distributed uniformly in the interval
[0., 1.).:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">UniformDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.17100770119577646</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="p">()</span>
<span class="go">0.49095047544687986</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="galsim.GaussianDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">GaussianDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">mean=0.0</em>, <em class="sig-param">sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#GaussianDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.GaussianDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random number generator with Gaussian distribution.</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Gaussian_distribution">http://en.wikipedia.org/wiki/Gaussian_distribution</a> for further details.</p>
<p>Successive calls to g() generate pseudo-random values distributed according to a Gaussian
distribution with the provided <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">GaussianDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">()</span>
<span class="go">0.5533754000847082</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">()</span>
<span class="go">1.0218588970190354</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>mean</strong> – Mean of Gaussian distribution. [default: 0.]</p></li>
<li><p><strong>sigma</strong> – Sigma of Gaussian distribution. [default: 1.; Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.GaussianDeviate.generate_from_variance">
<code class="sig-name descname">generate_from_variance</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#GaussianDeviate.generate_from_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.GaussianDeviate.generate_from_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many Gaussian deviate values using the existing array values as the
variance for each.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.PoissonDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">PoissonDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">mean=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#PoissonDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PoissonDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random Poisson deviate with specified <code class="docutils literal notranslate"><span class="pre">mean</span></code>.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">mean</span></code> sets the mean and variance of the Poisson deviate.  An integer deviate with
this distribution is returned after each call.
See <a class="reference external" href="http://en.wikipedia.org/wiki/Poisson_distribution">http://en.wikipedia.org/wiki/Poisson_distribution</a> for more details.</p>
<p>Successive calls to p() generate pseudo-random integer values distributed according to a Poisson
distribution with the specified <code class="docutils literal notranslate"><span class="pre">mean</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">PoissonDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">()</span>
<span class="go">94</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">()</span>
<span class="go">106</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>mean</strong> – Mean of the distribution. [default: 1; Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.PoissonDeviate.generate_from_expectation">
<code class="sig-name descname">generate_from_expectation</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#PoissonDeviate.generate_from_expectation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PoissonDeviate.generate_from_expectation" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many Poisson deviate values using the existing array values as the
expectation value (aka mean) for each.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.BinomialDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">BinomialDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">N=1</em>, <em class="sig-param">p=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#BinomialDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BinomialDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random Binomial deviate for <code class="docutils literal notranslate"><span class="pre">N</span></code> trials each of probability <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">N</span></code> is number of ‘coin flips,’ <code class="docutils literal notranslate"><span class="pre">p</span></code> is probability of ‘heads,’ and each call returns an integer
value where 0 &lt;= value &lt;= N gives the number of heads.  See
<a class="reference external" href="http://en.wikipedia.org/wiki/Binomial_distribution">http://en.wikipedia.org/wiki/Binomial_distribution</a> for more information.</p>
<p>Successive calls to b() generate pseudo-random integer values distributed according to a
binomial distribution with the provided <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">BinomialDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>N</strong> – The number of ‘coin flips’ per trial. [default: 1; Must be &gt; 0]</p></li>
<li><p><strong>p</strong> – The probability of success per coin flip. [default: 0.5; Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="galsim.Chi2Deviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">Chi2Deviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">n=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#Chi2Deviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.Chi2Deviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random Chi^2-distributed deviate for degrees-of-freedom parameter <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Chi-squared_distribution">http://en.wikipedia.org/wiki/Chi-squared_distribution</a> (note that k=n in the notation
adopted in the Boost.Random routine called by this class).  The Chi^2 distribution is a
real-valued distribution producing deviates &gt;= 0.</p>
<p>Successive calls to chi2() generate pseudo-random values distributed according to a chi-square
distribution with the specified degrees of freedom, <code class="docutils literal notranslate"><span class="pre">n</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Chi2Deviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span><span class="p">()</span>
<span class="go">7.9182211987712385</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi2</span><span class="p">()</span>
<span class="go">6.644121724269535</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>n</strong> – Number of degrees of freedom for the output distribution. [default: 1;
Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="galsim.GammaDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">GammaDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">k=1.0</em>, <em class="sig-param">theta=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#GammaDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.GammaDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>A Gamma-distributed deviate with shape parameter <code class="docutils literal notranslate"><span class="pre">k</span></code> and scale parameter <code class="docutils literal notranslate"><span class="pre">theta</span></code>.
See <a class="reference external" href="http://en.wikipedia.org/wiki/Gamma_distribution">http://en.wikipedia.org/wiki/Gamma_distribution</a>.
(Note: we use the k, theta notation. If you prefer alpha, beta, use k=alpha, theta=1/beta.)
The Gamma distribution is a real valued distribution producing deviates &gt;= 0.</p>
<p>Successive calls to p() generate pseudo-random values distributed according to a gamma
distribution with the specified shape and scale parameters <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">theta</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gam</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">GammaDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gam</span><span class="p">()</span>
<span class="go">0.37508882726316</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gam</span><span class="p">()</span>
<span class="go">1.3504199388358704</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>k</strong> – Shape parameter of the distribution. [default: 1; Must be &gt; 0]</p></li>
<li><p><strong>theta</strong> – Scale parameter of the distribution. [default: 1; Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="galsim.WeibullDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">WeibullDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">a=1.0</em>, <em class="sig-param">b=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#WeibullDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.WeibullDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>Pseudo-random Weibull-distributed deviate for shape parameter <code class="docutils literal notranslate"><span class="pre">a</span></code> and scale parameter <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>The Weibull distribution is related to a number of other probability distributions; in
particular, it interpolates between the exponential distribution (a=1) and the Rayleigh
distribution (a=2).
See <a class="reference external" href="http://en.wikipedia.org/wiki/Weibull_distribution">http://en.wikipedia.org/wiki/Weibull_distribution</a> (a=k and b=lambda in the notation adopted
in the Wikipedia article) for more details.  The Weibull distribution is real valued and
produces deviates &gt;= 0.</p>
<p>Successive calls to p() generate pseudo-random values distributed according to a Weibull
distribution with the specified shape and scale parameters <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">WeibullDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">()</span>
<span class="go">1.1038481241018219</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span><span class="p">()</span>
<span class="go">2.957052966368049</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>a</strong> – Shape parameter of the distribution. [default: 1; Must be &gt; 0]</p></li>
<li><p><strong>b</strong> – Scale parameter of the distribution. [default: 1; Must be &gt; 0]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="galsim.DistDeviate">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">DistDeviate</code><span class="sig-paren">(</span><em class="sig-param">seed=None</em>, <em class="sig-param">function=None</em>, <em class="sig-param">x_min=None</em>, <em class="sig-param">x_max=None</em>, <em class="sig-param">interpolant=None</em>, <em class="sig-param">npoints=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#DistDeviate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DistDeviate" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to draw random numbers from a user-defined probability distribution.</p>
<p>DistDeviate is a BaseDeviate class that can be used to draw from an arbitrary probability
distribution.  The probability distribution passed to DistDeviate can be given one of three
ways: as the name of a file containing a 2d ASCII array of x and P(x), as a LookupTable mapping
x to P(x), or as a callable function.</p>
<p>Once given a probability, DistDeviate creates a table of the cumulative probability and draws
from it using a UniformDeviate.  The precision of its outputs can be controlled with the
keyword <code class="docutils literal notranslate"><span class="pre">npoints</span></code>, which sets the number of points DistDeviate creates for its internal table
of CDF(x).  To prevent errors due to non-monotonicity, the interpolant for this internal table
is always linear.</p>
<p>Two keywords, <code class="docutils literal notranslate"><span class="pre">x_min</span></code> and <code class="docutils literal notranslate"><span class="pre">x_max</span></code>, define the support of the function.  They must be passed if
a callable function is given to DistDeviate, unless the function is a LookupTable, which has its
own defined endpoints.  If a filename or LookupTable is passed to DistDeviate, the use of
<code class="docutils literal notranslate"><span class="pre">x_min</span></code> or <code class="docutils literal notranslate"><span class="pre">x_max</span></code> will result in an error.</p>
<p>If given a table in a file, DistDeviate will construct an interpolated LookupTable to obtain
more finely gridded probabilities for generating the cumulative probability table.  The default
<code class="docutils literal notranslate"><span class="pre">interpolant</span></code> is linear, but any interpolant understood by LookupTable may be used.  We caution
against the use of splines because they can cause non-monotonic behavior.  Passing the
<code class="docutils literal notranslate"><span class="pre">interpolant</span></code> keyword next to anything but a table in a file will result in an error.</p>
<p>Examples:</p>
<p>Some sample initialization calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">DistDeviate</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">x_min</span><span class="o">=</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="n">x_max</span><span class="p">)</span>
</pre></div>
</div>
<p>Initializes d to be a DistDeviate instance with a distribution given by the callable function
<code class="docutils literal notranslate"><span class="pre">f(x)</span></code> from <code class="docutils literal notranslate"><span class="pre">x=x_min</span></code> to <code class="docutils literal notranslate"><span class="pre">x=x_max</span></code> and seeds the PRNG using current time.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">DistDeviate</span><span class="p">(</span><span class="mi">1062533</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">interpolant</span><span class="o">=</span><span class="s1">&#39;floor&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Initializes d to be a DistDeviate instance with a distribution given by the data in file
<code class="docutils literal notranslate"><span class="pre">file_name</span></code>, which must be a 2-column ASCII table, and seeds the PRNG using the integer
seed 1062533. It generates probabilities from <code class="docutils literal notranslate"><span class="pre">file_name</span></code> using the interpolant ‘floor’.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">DistDeviate</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">galsim</span><span class="o">.</span><span class="n">LookupTable</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<p>Initializes d to be a DistDeviate instance with a distribution given by P(x), defined as two
arrays <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">p</span></code> which are used to make a callable LookupTable, and links the DistDeviate
PRNG to the already-existing random number generator <code class="docutils literal notranslate"><span class="pre">rng</span></code>.</p>
<p>Successive calls to d() generate pseudo-random values with the given probability distribution.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">DistDeviate</span><span class="p">(</span><span class="mi">31415926</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x_min</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">()</span>
<span class="go">-0.4151921102709466</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">()</span>
<span class="go">-0.00909781188974034</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> – Something that can seed a BaseDeviate: an integer seed or another
BaseDeviate.  Using 0 means to generate a seed from the system.
[default: None]</p></li>
<li><p><strong>function</strong> – A callable function giving a probability distribution or the name of a
file containing a probability distribution as a 2-column ASCII table.
[required]</p></li>
<li><p><strong>x_min</strong> – The minimum desired return value (required for non-LookupTable
callable functions; will raise an error if not passed in that case, or if
passed in any other case) [default: None]</p></li>
<li><p><strong>x_max</strong> – The maximum desired return value (required for non-LookupTable
callable functions; will raise an error if not passed in that case, or if
passed in any other case) [default: None]</p></li>
<li><p><strong>interpolant</strong> – Type of interpolation used for interpolating a file (causes an error if
passed alongside a callable function).  Options are given in the
documentation for LookupTable. [default: ‘linear’]</p></li>
<li><p><strong>npoints</strong> – Number of points DistDeviate should create for its internal interpolation
tables. [default: 256, unless the function is a non-log LookupTable, in
which case it uses the table’s x values]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.DistDeviate.add_generate">
<code class="sig-name descname">add_generate</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#DistDeviate.add_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DistDeviate.add_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many pseudo-random values, adding them to the values of a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.DistDeviate.generate">
<code class="sig-name descname">generate</code><span class="sig-paren">(</span><em class="sig-param">array</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#DistDeviate.generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DistDeviate.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate many pseudo-random values, filling in the values of a numpy array.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.DistDeviate.val">
<code class="sig-name descname">val</code><span class="sig-paren">(</span><em class="sig-param">p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/random.html#DistDeviate.val"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DistDeviate.val" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value <code class="docutils literal notranslate"><span class="pre">x</span></code> of the input function to DistDeviate such that <code class="docutils literal notranslate"><span class="pre">p</span></code> = cdf(x),
where cdf is the cumulattive probability distribution function:</p>
<blockquote>
<div><p>cdf(x) = int(pdf(t), t=0..x)</p>
</div></blockquote>
<p>This function is typically called by self.__call__(), which generates a random p
between 0 and 1 and calls <code class="docutils literal notranslate"><span class="pre">self.val(p)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> – The desired cumulative probabilty p.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the corresponding x such that p = cdf(x).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="noise-generators">
<h2>Noise Generators<a class="headerlink" href="#noise-generators" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.BaseNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">BaseNoise</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#BaseNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all noise classes.</p>
<p>This class should not be constructed directly.  Rather, you should instantiate one of the
subclasses:</p>
<blockquote>
<div><p>GaussianNoise
PoissonNoise
CCDNoise
DeviateNoise
VariableGaussianNoise</p>
</div></blockquote>
<p>which define what kind of noise you want to implement.  This base class mostly just serves as
a way to check if an object is a valid noise object with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span> <span class="n">galsim</span><span class="o">.</span><span class="n">BaseNoise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="galsim.BaseNoise.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#BaseNoise.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseNoise.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Add noise to an input Image.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span><span class="o">.</span><span class="n">applyTo</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>On output the Image instance <code class="docutils literal notranslate"><span class="pre">image</span></code> will have been given additional noise according
to the current noise model.</p>
<p>Note: This is equivalent to the alternate syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>which may be more convenient or clearer.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseNoise.getVariance">
<code class="sig-name descname">getVariance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#BaseNoise.getVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseNoise.getVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Get variance in current noise model.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseNoise.withScaledVariance">
<code class="sig-name descname">withScaledVariance</code><span class="sig-paren">(</span><em class="sig-param">variance_ratio</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#BaseNoise.withScaledVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseNoise.withScaledVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new noise object with the variance scaled up by the specified factor.</p>
<p>This is equivalent to noise * variance_ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variance_ratio</strong> – The factor by which to scale the variance of the correlation
function profile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Noise object whose variance has been scaled by the given amount.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.BaseNoise.withVariance">
<code class="sig-name descname">withVariance</code><span class="sig-paren">(</span><em class="sig-param">variance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#BaseNoise.withVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.BaseNoise.withVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new noise object (of the same type as the current one) with the specified
variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variance</strong> – The desired variance in the noise.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new Noise object with the given variance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.GaussianNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">GaussianNoise</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em>, <em class="sig-param">sigma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#GaussianNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.GaussianNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing simple Gaussian noise.</p>
<p>This is a simple noise model where each pixel in the image gets Gaussian noise with a
given <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
<p>Example:</p>
<p>The following will add Gaussian noise to every element of an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">GaussianNoise</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">gaussian_noise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – A BaseDeviate instance to use for generating the random numbers.</p></li>
<li><p><strong>sigma</strong> – The rms noise on each pixel. [default: 1.]</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rng</strong> – The internal random number generator (read-only)</p></li>
<li><p><strong>sigma</strong> – The value of the constructor parameter sigma (read-only)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.GaussianNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#GaussianNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.GaussianNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the Gaussian noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise_copy</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.PoissonNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">PoissonNoise</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em>, <em class="sig-param">sky_level=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#PoissonNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PoissonNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing Poisson noise according to the flux (and sky level) present in the image.</p>
<p>The PoissonNoise class encapsulates a simple version of the noise model of a normal CCD image
where each pixel has Poisson noise corresponding to the number of electrons in each pixel
(including an optional extra sky level).</p>
<p>Note that if the image to which you are adding noise already has a sky level on it,
then you should not provide the sky level here as well.  The sky level here corresponds
to a level that is taken to be already subtracted from the image, but that originally
contributed to the addition of Poisson noise.</p>
<p>Example:</p>
<p>The following will add Poisson noise to every element of an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">PoissonNoise</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">sky_level</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">poisson_noise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – A BaseDeviate instance to use for generating the random numbers.</p></li>
<li><p><strong>sky_level</strong> – The sky level in electrons per pixel that was originally in the input image,
but which is taken to have already been subtracted off. [default: 0.]</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rng</strong> – The internal random number generator (read-only)</p></li>
<li><p><strong>sky_level</strong> – The value of the constructor parameter sky_level (read-only)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.PoissonNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#PoissonNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.PoissonNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the Poisson noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise_copy</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.CCDNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">CCDNoise</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em>, <em class="sig-param">sky_level=0.0</em>, <em class="sig-param">gain=1.0</em>, <em class="sig-param">read_noise=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#CCDNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.CCDNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing a basic CCD noise model.</p>
<p>The CCDNoise class encapsulates the noise model of a normal CCD image.  The noise has two
components: first, Poisson noise corresponding to the number of electrons in each pixel
(including an optional extra sky level); second, Gaussian read noise.</p>
<p>Note that if the image to which you are adding noise already has a sky level on it,
then you should not provide the sky level here as well.  The sky level here corresponds
to a level is taken to be already subtracted from the image, but which was present
for the Poisson noise.</p>
<p>The units here are slightly confusing.  We try to match the most common way that each of
these quantities is usually reported.  Note: ADU stands for Analog/Digital Units; they are the
units of the numbers in the final image.  Some places use the term “counts” for this.</p>
<ul class="simple">
<li><p>sky_level is normally measured from the image itself, so it is normally quoted in ADU/pixel.</p></li>
<li><p>gain is a property of the detector and is normally measured in the laboratory.  The units
are normally e-/ADU.  This is backwards what might be more intuitive, ADU/e-, but that’s
how astronomers use the term gain, so we follow suit here.</p></li>
<li><p>read_noise is also a property of the detector and is usually quoted in e-/pixel.</p></li>
</ul>
<p>If you are manually applying the quantum efficiency of the detector (e-/photon), then this
would normally be applied before the noise.  However, it is also fine to fold in the quantum
efficiency into the gain to give units photons/ADU.  Either way is acceptable.  Just make sure
you give the read noise in photons as well in this case.</p>
<p>Example:</p>
<p>The following will add CCD noise to every element of an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ccd_noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CCDNoise</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">sky_level</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">gain</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">read_noise</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">ccd_noise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – A BaseDeviate instance to use for generating the random numbers.</p></li>
<li><p><strong>sky_level</strong> – The sky level in ADU per pixel that was originally in the input image,
but which is taken to have already been subtracted off. [default: 0.]</p></li>
<li><p><strong>gain</strong> – The gain for each pixel in electrons per ADU; setting <code class="docutils literal notranslate"><span class="pre">gain&lt;=0</span></code> will shut
off the Poisson noise, and the Gaussian rms will take the value
<code class="docutils literal notranslate"><span class="pre">read_noise</span></code> as being in units of ADU rather than electrons. [default: 1.]</p></li>
<li><p><strong>read_noise</strong> – The read noise on each pixel in electrons (gain &gt; 0.) or ADU (gain &lt;= 0.).
Setting <code class="docutils literal notranslate"><span class="pre">read_noise=0</span></code>. will shut off the Gaussian noise. [default: 0.]</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rng</strong> – The internal random number generator (read-only)</p></li>
<li><p><strong>sky_level</strong> – The value of the constructor parameter sky_level (read-only)</p></li>
<li><p><strong>gain</strong> – The value of the constructor parameter gain (read-only)</p></li>
<li><p><strong>read_noise</strong> – The value of the constructor parameter read_noise (read-only)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.CCDNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#CCDNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.CCDNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the CCD noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise_copy</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.DeviateNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">DeviateNoise</code><span class="sig-paren">(</span><em class="sig-param">dev</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#DeviateNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DeviateNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing noise with an arbitrary BaseDeviate object.</p>
<p>The DeviateNoise class provides a way to treat an arbitrary deviate as the noise model for
each pixel in an image.</p>
<p>The following will add noise according to a given random deviate to every element of an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev_noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">DeviateNoise</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">dev_noise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dev</strong> – A BaseDeviate subclass to use as the noise deviate for each pixel.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><p><strong>rng</strong> – The internal random number generator (read-only)</p>
</dd>
</dl>
<dl class="method">
<dt id="galsim.DeviateNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#DeviateNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.DeviateNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the Deviate noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise_copy</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.VariableGaussianNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">VariableGaussianNoise</code><span class="sig-paren">(</span><em class="sig-param">rng</em>, <em class="sig-param">var_image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#VariableGaussianNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.VariableGaussianNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Class implementing Gaussian noise that has a different variance in each pixel.</p>
<p>The following will add variable Gaussian noise to every element of an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variable_noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">VariableGaussianNoise</span><span class="p">(</span><span class="n">rng</span><span class="p">,</span> <span class="n">var_image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">variable_noise</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> – A BaseDeviate instance to use for generating the random numbers.</p></li>
<li><p><strong>var_image</strong> – The variance of the noise to apply to each pixel.  This image must be the
same shape as the image for which you eventually call addNoise().</p></li>
</ul>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rng</strong> – The internal random number generator (read-only)</p></li>
<li><p><strong>var_image</strong> – The value of the constructor parameter var_image (read-only)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="galsim.VariableGaussianNoise.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#VariableGaussianNoise.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.VariableGaussianNoise.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Add noise to an input Image.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span><span class="o">.</span><span class="n">applyTo</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>On output the Image instance <code class="docutils literal notranslate"><span class="pre">image</span></code> will have been given additional noise according
to the current noise model.</p>
<p>Note: This is equivalent to the alternate syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>which may be more convenient or clearer.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.VariableGaussianNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/noise.html#VariableGaussianNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.VariableGaussianNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the variable Gaussian noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">noise_copy</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="correlated-noise-generators">
<h2>Correlated Noise Generators<a class="headerlink" href="#correlated-noise-generators" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.correlatednoise.</code><code class="sig-name descname">_BaseCorrelatedNoise</code><span class="sig-paren">(</span><em class="sig-param">rng</em>, <em class="sig-param">gsobject</em>, <em class="sig-param">wcs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>A Base Class describing 2D correlated Gaussian random noise fields.</p>
<p>A _BaseCorrelatedNoise will not generally be instantiated directly.  This is recommended as the
current <code class="docutils literal notranslate"><span class="pre">_BaseCorrelatedNoise.__init__</span></code> interface does not provide any guarantee that the input
GSObject represents a physical correlation function, e.g. a profile that is an even function
(two-fold rotationally symmetric in the plane) and peaked at the origin.  The proposed pattern
is that users instead instantiate derived classes, such as the CorrelatedNoise, which are able
to guarantee the above.</p>
<p>The _BaseCorrelatedNoise is therefore here primarily to define the way in which derived classes
(currently only CorrelatedNoise and UncorrelatedNoise) store the random deviate, noise
correlation function profile and allow operations with it, generate images containing noise with
these correlation properties, and generate covariance matrices according to the correlation
function.</p>
<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.applyTo">
<code class="sig-name descname">applyTo</code><span class="sig-paren">(</span><em class="sig-param">image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.applyTo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.applyTo" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply this correlated Gaussian random noise field to an input Image.</p>
<p>To add deviates to every element of an image, the syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">correlated_noise</span><span class="p">)</span>
</pre></div>
</div>
<p>is preferred.  However, this is equivalent to calling this instance’s applyTo() method as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">correlated_noise</span><span class="o">.</span><span class="n">applyTo</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>On output the Image instance <code class="docutils literal notranslate"><span class="pre">image</span></code> will have been given additional noise according to the
given CorrelatedNoise instance <code class="docutils literal notranslate"><span class="pre">correlated_noise</span></code>.  Normally, <code class="docutils literal notranslate"><span class="pre">image.scale</span></code> is used to
determine the input Image pixel separation, and if <code class="docutils literal notranslate"><span class="pre">image.scale</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> a pixel scale of 1 is
assumed.  If the image has a non-uniform WCS, the local uniform approximation at the center
of the image will be used.</p>
<p>Note that the correlations defined in a correlated_noise object are defined in terms of
world coordinates (i.e. typically arcsec on the sky).  Some care is thus required if you
apply correlated noise to an image with a non-trivial WCS.  The correlations will have a
specific direction and scale in world coordinates, so if you apply them to an image with
a WCS that has a rotation or a different pixel scale than the original, the resulting
correlations will have the correct direction and scale in world coordinates, but a
different direction and/or scale in image coordinates.</p>
<p>If you want to override this behavior, you can view your image with the WCS of the
correlation function and apply the noise to that.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">complicated_wcs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">getCOSMOSNoise</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">wcs</span><span class="o">=</span><span class="n">noise</span><span class="o">.</span><span class="n">wcs</span><span class="p">)</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>This will create noise whose pixel-to-pixel correlations match those of the original
correlated noise image (in this case, the COSMOS images).  If the input image has no WCS
set, then it will be treated as having the same WCS as the noise.</p>
<p>Note that the correlated noise field in <code class="docutils literal notranslate"><span class="pre">image</span></code> will be periodic across its boundaries: this
is due to the fact that the internals of the CorrelatedNoise currently use a relatively
simple implementation of noise generation using the Fast Fourier Transform.  If you wish to
avoid this property being present in your final <code class="docutils literal notranslate"><span class="pre">image</span></code> you should add the noise to an
<code class="docutils literal notranslate"><span class="pre">image</span></code> of greater extent than you need, and take a subset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> – The input Image object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.convolvedWith">
<code class="sig-name descname">convolvedWith</code><span class="sig-paren">(</span><em class="sig-param">gsobject</em>, <em class="sig-param">gsparams=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.convolvedWith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.convolvedWith" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolve the correlated noise model with an input GSObject.</p>
<p>The resulting correlated noise model will then give a statistical description of the noise
field that would result from convolving noise generated according to the initial correlated
noise with a kernel represented by <code class="docutils literal notranslate"><span class="pre">gsobject</span></code> (e.g. a PSF).</p>
<p>The practical purpose of this method is that it allows us to model what is happening to
noise in the images from Hubble Space Telescope that we use for simulating PSF convolved
galaxies with the RealGalaxy class.</p>
<p>This modifies the representation of the correlation function, but leaves the random number
generator unchanged.</p>
<p>Examples:</p>
<p>The following command simply applies a Moffat PSF with slope parameter beta=3. and
FWHM=0.7:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">convolvedWith</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Moffat</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>
</pre></div>
</div>
<p>Often we will want to convolve with more than one function.  For example, if we wanted to
simulate how a noise field would look if convolved with a ground-based PSF (such as the
Moffat above) and then rendered onto a new (typically larger) pixel grid, the following
example command demonstrates the syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">convolvedWith</span><span class="p">(</span>
<span class="gp">... </span>   <span class="n">galsim</span><span class="o">.</span><span class="n">Convolve</span><span class="p">([</span><span class="n">galsim</span><span class="o">.</span><span class="n">Deconvolve</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Pixel</span><span class="p">(</span><span class="mf">0.03</span><span class="p">)),</span>
<span class="gp">... </span>                    <span class="n">galsim</span><span class="o">.</span><span class="n">Pixel</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Moffat</span><span class="p">(</span><span class="mf">3.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">0.7</span><span class="p">),</span>
</pre></div>
</div>
<p>Note, we also deconvolve by the original pixel, which should be the pixel size of the
image from which the <code class="docutils literal notranslate"><span class="pre">correlated_noise</span></code> was made.  This command above is functionally
equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">convolvedWith</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Deconvolve</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Pixel</span><span class="p">(</span><span class="mf">0.03</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">convolvedWith</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Pixel</span><span class="p">(</span><span class="mf">0.2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">convolvedWith</span><span class="p">(</span><span class="n">galsim</span><span class="o">.</span><span class="n">Moffat</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">0.7</span><span class="p">))</span>
</pre></div>
</div>
<p>as is demanded for a linear operation such as convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gsobject</strong> – A GSObject or derived class instance representing the function
with which the user wants to convolve the correlated noise model.</p></li>
<li><p><strong>gsparams</strong> – An optional GSParams argument.  See the docstring for GSParams for
details. [default: None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the new CorrelatedNoise of the convolved profile.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">rng=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a copy of the correlated noise model.</p>
<p>By default, the copy will share the BaseDeviate random number generator with the parent
instance.  However, you can provide a new rng to use in the copy if you want with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn_copy</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">new_rng</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.dilate">
<code class="sig-name descname">dilate</code><span class="sig-paren">(</span><em class="sig-param">scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.dilate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.dilate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the appropriate changes to the scale and variance for when the object has
an applied dilation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> – The linear dilation scale factor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified dilation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.drawImage">
<code class="sig-name descname">drawImage</code><span class="sig-paren">(</span><em class="sig-param">image=None</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">wcs=None</em>, <em class="sig-param">dtype=None</em>, <em class="sig-param">add_to_image=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.drawImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.drawImage" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for drawing profiles storing correlation functions.</p>
<p>This is a mild reimplementation of the drawImage() method for GSObjects.  The <code class="docutils literal notranslate"><span class="pre">method</span></code> is
automatically set to ‘sb’ and cannot be changed, and the <code class="docutils literal notranslate"><span class="pre">gain</span></code> is set to unity.
Also, not all the normal parameters of the GSObject method are available.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scale</span></code> and <code class="docutils literal notranslate"><span class="pre">wcs</span></code> are not set, and the <code class="docutils literal notranslate"><span class="pre">image</span></code> has no <code class="docutils literal notranslate"><span class="pre">wcs</span></code> attribute, then this will
use the wcs of the CorrelatedNoise object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – If provided, this will be the image on which to draw the profile.
If <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, then an automatically-sized Image will be created.
If <code class="docutils literal notranslate"><span class="pre">image</span></code> is given, but its bounds are undefined (e.g. if it was
constructed with <code class="docutils literal notranslate"><span class="pre">image</span> <span class="pre">=</span> <span class="pre">galsim.Image()</span></code>), then it will be resized
appropriately based on the profile’s size [default: None].</p></li>
<li><p><strong>scale</strong> – If provided, use this as the pixel scale for the image.  [default: None]</p></li>
<li><p><strong>wcs</strong> – If provided, use this as the wcs for the image (possibly overriding any
existing <code class="docutils literal notranslate"><span class="pre">image.wcs</span></code>).  At most one of <code class="docutils literal notranslate"><span class="pre">scale</span></code> or <code class="docutils literal notranslate"><span class="pre">wcs</span></code> may be provided.
[default: None]  Note: If no WCS is provided either via <code class="docutils literal notranslate"><span class="pre">scale</span></code>, <code class="docutils literal notranslate"><span class="pre">wcs</span></code>
or <code class="docutils literal notranslate"><span class="pre">image.wcs</span></code>, then the noise object’s wcs will be used.</p></li>
<li><p><strong>dtype</strong> – The data type to use for an automatically constructed image.  Only
valid if <code class="docutils literal notranslate"><span class="pre">image</span></code> is None. [default: None, which means to use
numpy.float32]</p></li>
<li><p><strong>add_to_image</strong> – Whether to add flux to the existing image rather than clear out
anything in the image before drawing.
Note: This requires that <code class="docutils literal notranslate"><span class="pre">image</span></code> be provided and that it have defined
bounds. [default: False]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an Image of the correlation function.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.drawKImage">
<code class="sig-name descname">drawKImage</code><span class="sig-paren">(</span><em class="sig-param">image=None</em>, <em class="sig-param">nx=None</em>, <em class="sig-param">ny=None</em>, <em class="sig-param">bounds=None</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">add_to_image=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.drawKImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.drawKImage" title="Permalink to this definition">¶</a></dt>
<dd><p>A method for drawing profiles storing correlation functions (i.e., power spectra) in
Fourier space.</p>
<p>This is a mild reimplementation of the drawKImage() method for GSObjects.  The <code class="docutils literal notranslate"><span class="pre">gain</span></code> is
automatically set to unity and cannot be change.  Also, not all the normal parameters of the
GSObject method are available.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is not set, and <code class="docutils literal notranslate"><span class="pre">image</span></code> has no <code class="docutils literal notranslate"><span class="pre">wcs</span></code> attribute, then this will use the
wcs of the CorrelatedNoise object, which must be a <a class="reference internal" href="wcs.html#galsim.PixelScale" title="galsim.PixelScale"><code class="xref any py py-class docutils literal notranslate"><span class="pre">PixelScale</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – If provided, this will be the Image onto which to draw the k-space
image.  If <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, then an automatically-sized image will be
created.  If <code class="docutils literal notranslate"><span class="pre">image</span></code> is given, but its bounds are undefined, then it
will be resized appropriately based on the profile’s size.
[default: None]</p></li>
<li><p><strong>nx</strong> – If provided and <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, use to set the x-direction size of the
image.  Must be accompanied by <code class="docutils literal notranslate"><span class="pre">ny</span></code>.</p></li>
<li><p><strong>ny</strong> – If provided and <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, use to set the y-direction size of the
image.  Must be accompanied by <code class="docutils literal notranslate"><span class="pre">nx</span></code>.</p></li>
<li><p><strong>bounds</strong> – If provided and <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, use to set the bounds of the image.</p></li>
<li><p><strong>scale</strong> – If provided, use this as the pixel scale, dk, for the images.
If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is None and <code class="docutils literal notranslate"><span class="pre">image</span></code> is given, then take the provided
images’ pixel scale (which must be equal).
If <code class="docutils literal notranslate"><span class="pre">scale</span></code> is None and <code class="docutils literal notranslate"><span class="pre">image</span></code> is None, then use the Nyquist scale.
If <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">&lt;=</span> <span class="pre">0</span></code> (regardless of <code class="docutils literal notranslate"><span class="pre">image</span></code>), then use the Nyquist scale.
[default: None]</p></li>
<li><p><strong>add_to_image</strong> – Whether to add to the existing images rather than clear out
anything in the image before drawing.
Note: This requires that <code class="docutils literal notranslate"><span class="pre">image</span></code> be provided and that it has defined
bounds. [default: False]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the tuple of Image instances, <code class="docutils literal notranslate"><span class="pre">(re,</span> <span class="pre">im)</span></code> (created if necessary)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.expand">
<code class="sig-name descname">expand</code><span class="sig-paren">(</span><em class="sig-param">scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.expand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the linear scale of correlations in this noise model by <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p>
<p>Scales the linear dimensions of the image by the factor <code class="docutils literal notranslate"><span class="pre">scale</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">half_light_radius</span></code> &lt;– <code class="docutils literal notranslate"><span class="pre">half_light_radius</span> <span class="pre">*</span> <span class="pre">scale</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> – The linear rescaling factor to apply.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified expansion.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.getVariance">
<code class="sig-name descname">getVariance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.getVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.getVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the point variance of this noise field, equal to its correlation function value at
zero distance.</p>
<p>This is the variance of values in an image filled with noise according to this model.</p>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.lens">
<code class="sig-name descname">lens</code><span class="sig-paren">(</span><em class="sig-param">g1</em>, <em class="sig-param">g2</em>, <em class="sig-param">mu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.lens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.lens" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the appropriate changes for when the object has an applied shear and magnification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g1</strong> – First component of lensing (reduced) shear to apply to the object.</p></li>
<li><p><strong>g2</strong> – Second component of lensing (reduced) shear to apply to the object.</p></li>
<li><p><strong>mu</strong> – Lensing magnification to apply to the object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified shear and magnification.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.magnify">
<code class="sig-name descname">magnify</code><span class="sig-paren">(</span><em class="sig-param">mu</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.magnify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.magnify" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the appropriate changes to the scale and variance for when the object has
an applied magnification <code class="docutils literal notranslate"><span class="pre">mu</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mu</strong> – The lensing magnification</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified magnification.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param">theta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a rotation <code class="docutils literal notranslate"><span class="pre">theta</span></code> to this correlated noise model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>theta</strong> – Rotation angle (Angle object, positive means anticlockwise).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified rotation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.shear">
<code class="sig-name descname">shear</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.shear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.shear" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a shear to this correlated noise model, where arguments are either a Shear,
or arguments that will be used to initialize one.</p>
<p>For more details about the allowed keyword arguments, see the documentation for Shear
(for doxygen documentation, see galsim.Shear).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>shear</strong> – The shear to be applied. Or, as described above, you may instead supply
parameters do construct a shear directly.  eg. <code class="docutils literal notranslate"><span class="pre">corr.shear(g1=g1,g2=g2)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified shear.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.symmetrizeImage">
<code class="sig-name descname">symmetrizeImage</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">order=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.symmetrizeImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.symmetrizeImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply noise designed to impose N-fold symmetry on the existing noise in a (square) input
Image.</p>
<p>When called for a non-square image, this method will raise an exception, unlike the noise
whitening routines.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">order</span></code> of the symmetry can be supplied as a keyword argument, with the default being
4 because this is presumably the minimum required for the anisotropy of noise correlations
to not affect shear statistics.</p>
<p>Note: the syntax <code class="docutils literal notranslate"><span class="pre">image.symmetrizeNoise(noise,</span> <span class="pre">order)</span></code> is preferred, but it is equivalent
to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">correlated_noise</span><span class="o">.</span><span class="n">symmetrizeImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<p>On output the Image instance <code class="docutils literal notranslate"><span class="pre">image</span></code> will have been given additional noise according to a
specified CorrelatedNoise instance, designed to symmetrize the correlated noise that may
have originally existed in <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">image</span></code> originally contained noise with a correlation function described by the
<code class="docutils literal notranslate"><span class="pre">correlated_noise</span></code> instance, the combined noise after using the symmetrizeImage() method
will have a noise correlation function with N-fold symmetry, where <code class="docutils literal notranslate"><span class="pre">N=order</span></code>.</p>
<p>Note that the code doesn’t check that the “if” above is true: the user MUST make sure this
is the case for the final noise correlation function to be symmetric in the requested way.</p>
<p>Normally, <code class="docutils literal notranslate"><span class="pre">image.scale</span></code> is used to determine the input Image pixel separation, and if
<code class="docutils literal notranslate"><span class="pre">image.wcs</span></code> is None, it will use the wcs of the noise.  If the image has a non-uniform WCS,
the local uniform approximation at the center of the image will be used.</p>
<p>If you are interested in a theoretical calculation of the variance in the final noise field
after imposing symmetry, the symmetrizeImage() method in fact returns this variance.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variance</span> <span class="o">=</span> <span class="n">correlated_noise</span><span class="o">.</span><span class="n">symmetrizeImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
</pre></div>
</div>
<p>For context, in comparison with the whitenImage() method for the case of noise
correlation functions that are roughly like those in the COSMOS HST data, the amount of
noise added to impose N-fold symmetry is usually much less than what is added to fully
whiten the noise.  The usage of symmetrizeImage() is totally analogous to the usage of
whitenImage().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – The square input Image object.</p></li>
<li><p><strong>order</strong> – The order at which to require the noise to be symmetric.  All noise fields
are already 2-fold symmetric, so <code class="docutils literal notranslate"><span class="pre">order</span></code> should be an even integer &gt;2.
[default: 4].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the theoretically calculated variance of the combined noise fields in the updated image.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">dudx</em>, <em class="sig-param">dudy</em>, <em class="sig-param">dvdx</em>, <em class="sig-param">dvdy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an arbitrary jacobian transformation to this correlated noise model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dudx</strong> – du/dx, where (x,y) are the current coords, and (u,v) are the new coords.</p></li>
<li><p><strong>dudy</strong> – du/dy, where (x,y) are the current coords, and (u,v) are the new coords.</p></li>
<li><p><strong>dvdx</strong> – dv/dx, where (x,y) are the current coords, and (u,v) are the new coords.</p></li>
<li><p><strong>dvdy</strong> – dv/dy, where (x,y) are the current coords, and (u,v) are the new coords.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a new CorrelatedNoise object with the specified transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.whitenImage">
<code class="sig-name descname">whitenImage</code><span class="sig-paren">(</span><em class="sig-param">image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.whitenImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.whitenImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply noise designed to whiten correlated Gaussian random noise in an input Image.</p>
<p>On output the Image instance <code class="docutils literal notranslate"><span class="pre">image</span></code> will have been given additional noise according to
a specified CorrelatedNoise instance, designed to whiten any correlated noise that may have
originally existed in <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<p>Note: the syntax <code class="docutils literal notranslate"><span class="pre">image.whitenNoise(noise)</span></code> is normally preferred, but it is equivalent
to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">correlated_noise</span><span class="o">.</span><span class="n">whitenImage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">image</span></code> originally contained noise with a correlation function described by the
<code class="docutils literal notranslate"><span class="pre">correlated_noise</span></code> instance, the combined noise after using the whitenImage() method
will be approximately uncorrelated.  Tests using COSMOS noise fields suggest ~0.3% residual
off-diagonal covariances after whitening, relative to the variance, although results may
vary depending on the precise correlation function of the noise field.
(See <code class="docutils literal notranslate"><span class="pre">devel/external/hst/compare_whitening_subtraction.py</span></code> for the COSMOS tests.)</p>
<p>Note that the code doesn’t check that the “if” above is true: the user MUST make sure this
is the case for the final noise to be uncorrelated.</p>
<p>Normally, <code class="docutils literal notranslate"><span class="pre">image.scale</span></code> is used to determine the input Image pixel separation, and if
<code class="docutils literal notranslate"><span class="pre">image.wcs</span></code> is None, it will use the wcs of the noise.  If the image has a non-uniform WCS,
the local uniform approximation at the center of the image will be used.</p>
<p>If you are interested in a theoretical calculation of the variance in the final noise field
after whitening, the whitenImage() method in fact returns this variance.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">variance</span> <span class="o">=</span> <span class="n">correlated_noise</span><span class="o">.</span><span class="n">whitenImage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<p>To see noise whitening in action, let us use a model of the correlated noise in COSMOS
as returned by the getCOSMOSNoise() function.  Let’s initialize and add noise to an image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">getCOSMOSNoise</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">ImageD</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The scale should match the COSMOS default since didn&#39;t specify another</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">image</span></code> will then contain a realization of a random noise field with COSMOS-like
correlation.  Using the whitenImage() method, we can now add more noise to <code class="docutils literal notranslate"><span class="pre">image</span></code>
with a power spectrum specifically designed to make the combined noise fields uncorrelated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span><span class="o">.</span><span class="n">whitenImage</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>Of course, this whitening comes at the cost of adding further noise to the image, but
the algorithm is designed to make this additional noise (nearly) as small as possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> – The input Image object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the theoretically calculated variance of the combined noise fields in the updated image.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.withScaledVariance">
<code class="sig-name descname">withScaledVariance</code><span class="sig-paren">(</span><em class="sig-param">variance_ratio</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.withScaledVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.withScaledVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the entire correlated noise field by the given factor.</p>
<p>This is equivalent to cn * variance_ratio.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variance_ratio</strong> – The factor by which to scale the variance of the correlation
function profile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a CorrelatedNoise object whose variance and covariances have been scaled up by
the given factor.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="galsim.correlatednoise._BaseCorrelatedNoise.withVariance">
<code class="sig-name descname">withVariance</code><span class="sig-paren">(</span><em class="sig-param">variance</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#_BaseCorrelatedNoise.withVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.correlatednoise._BaseCorrelatedNoise.withVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the point variance of the noise field, equal to its correlation function value at
zero distance, to an input <code class="docutils literal notranslate"><span class="pre">variance</span></code>.  The rest of the correlated noise field is scaled
proportionally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variance</strong> – The desired point variance in the noise.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a CorrelatedNoise object with the new variance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="galsim.CorrelatedNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">CorrelatedNoise</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">rng=None</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">wcs=None</em>, <em class="sig-param">x_interpolant=None</em>, <em class="sig-param">correct_periodicity=True</em>, <em class="sig-param">subtract_mean=False</em>, <em class="sig-param">gsparams=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#CorrelatedNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.CorrelatedNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that represents 2D correlated noise fields calculated from an input Image.</p>
<p>This class stores an internal representation of a 2D, discrete correlation function, and allows
a number of subsequent operations including interpolation, shearing, magnification and rendering
of the correlation function profile into an output Image.  The class also allows correlated
Gaussian noise fields to be generated according to the correlation function, and added to an
Image: see the applyTo() method.  It also provides methods for whitening or imposing N-fold
symmetry on pre-existing noise that shares the same spatial correlations: see the
whitenImage() and symmetrizeImage() methods, respectively.</p>
<p>It also allows the combination of multiple correlation functions by addition, and for the
scaling of the total variance they represent by scalar factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – The image from which to derive the correlated noise profile</p></li>
<li><p><strong>rng</strong> – A BaseDeviate instance to use for generating the random numbers.</p></li>
<li><p><strong>scale</strong> – If provided, use this as the pixel scale.  Normally, the scale (or wcs)
is taken from the image.wcs field, but you may override that by
providing either scale or wcs.  [default: use image.wcs if defined,
else 1.0, unless <code class="docutils literal notranslate"><span class="pre">wcs</span></code> is provided]</p></li>
<li><p><strong>wcs</strong> – If provided, use this as the wcs for the image.  At most one of <code class="docutils literal notranslate"><span class="pre">scale</span></code>
or <code class="docutils literal notranslate"><span class="pre">wcs</span></code> may be provided. [default: None]</p></li>
<li><p><strong>x_interpolant</strong> – The interpolant to use for interpolating the image of the correlation
function. (See below.) [default: galsim.Linear(tol=1.e-4)]</p></li>
<li><p><strong>correct_periodicity</strong> – Whether to correct for the effects of periodicity.  (See below.)
[default: True]</p></li>
<li><p><strong>subtract_mean</strong> – Whether to subtract off the mean value from the image before computing
the correlation function. [default: False]</p></li>
<li><p><strong>gsparams</strong> – An optional GSParams argument.  See the docstring for GSParams for
details. [default: None]</p></li>
</ul>
</dd>
</dl>
<p>Basic example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CorrelatedNoise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
</pre></div>
</div>
<p>Instantiates a CorrelatedNoise using the pixel scale information contained in <code class="docutils literal notranslate"><span class="pre">image.scale</span></code>
(assumes the scale is unity if <code class="docutils literal notranslate"><span class="pre">image.scale</span> <span class="pre">&lt;=</span> <span class="pre">0.</span></code>) by calculating the correlation function
in the input <code class="docutils literal notranslate"><span class="pre">image</span></code>.  The input <code class="docutils literal notranslate"><span class="pre">rng</span></code> must be a BaseDeviate or derived class instance,
setting the random number generation for the noise.</p>
<p>Optional Inputs: Interpolant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CorrelatedNoise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<p>The example above instantiates a CorrelatedNoise, but forces the use of the pixel scale
<code class="docutils literal notranslate"><span class="pre">scale</span></code> to set the units of the internal lookup table.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CorrelatedNoise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">x_interpolant</span><span class="o">=</span><span class="n">galsim</span><span class="o">.</span><span class="n">Lanczos</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1.e-4</span><span class="p">))</span>
</pre></div>
</div>
<p>The example above instantiates a CorrelatedNoise, but forces use of a non-default interpolant
for interpolation of the internal lookup table in real space.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">x_interpolant</span></code> is <code class="docutils literal notranslate"><span class="pre">galsim.Linear(tol=1.e-4)</span></code>, which uses bilinear interpolation.
The use of this interpolant is an approximation that gives good empirical results without
requiring internal convolution of the correlation function profile by a Pixel object when
applying correlated noise to images: such an internal convolution has been found to be
computationally costly in practice, requiring the Fourier transform of very large arrays.</p>
<p>The use of the bilinear interpolants means that the representation of correlated noise will be
noticeably inaccurate in at least the following two regimes:</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>If the pixel scale of the desired final output (e.g. the target image of drawImage(),
applyTo() or whitenImage()) is small relative to the separation between pixels
in the <code class="docutils literal notranslate"><span class="pre">image</span></code> used to instantiate <code class="docutils literal notranslate"><span class="pre">cn</span></code> as shown above.</p></li>
<li><p>If the CorrelatedNoise instance <code class="docutils literal notranslate"><span class="pre">cn</span></code> was instantiated with an image of scale comparable
to that in the final output, and <code class="docutils literal notranslate"><span class="pre">cn</span></code> has been rotated or otherwise transformed (e.g.
via the rotate(), shear() methods, see below).</p></li>
</ol>
</div></blockquote>
<p>Conversely, the approximation will work best in the case where the correlated noise used to
instantiate the <code class="docutils literal notranslate"><span class="pre">cn</span></code> is taken from an input image for which <code class="docutils literal notranslate"><span class="pre">image.scale</span></code> is smaller than that
in the desired output.  This is the most common use case in the practical treatment of
correlated noise when simulating galaxies from space telescopes, such as COSMOS.</p>
<p>Changing from the default bilinear interpolant is made possible, but not recommended.  For more
information please see the discussion on <a class="reference external" href="https://github.com/GalSim-developers/GalSim/pull/452">https://github.com/GalSim-developers/GalSim/pull/452</a>.</p>
<p>Optional Inputs: Periodicity Correction:</p>
<p>There is also an option to switch off an internal correction for assumptions made about the
periodicity in the input noise image.  If you wish to turn this off you may, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CorrelatedNoise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">correct_periodicity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The default and generally recommended setting is <code class="docutils literal notranslate"><span class="pre">correct_periodicity=True</span></code>.</p>
<p>Users should note that the internal calculation of the discrete correlation function in <code class="docutils literal notranslate"><span class="pre">image</span></code>
will assume that <code class="docutils literal notranslate"><span class="pre">image</span></code> is periodic across its boundaries, introducing a dilution bias in the
estimate of inter-pixel correlations that increases with separation.  Unless you know that the
noise in <code class="docutils literal notranslate"><span class="pre">image</span></code> is indeed periodic (perhaps because you generated it to be so), you will not
generally wish to use the <code class="docutils literal notranslate"><span class="pre">correct_periodicity=False</span></code> option.</p>
<p>By default, the image is not mean subtracted before the correlation function is estimated.  To
do an internal mean subtraction, you can set the <code class="docutils literal notranslate"><span class="pre">subtract_mean</span></code> keyword to <code class="docutils literal notranslate"><span class="pre">True</span></code>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">CorrelatedNoise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">subtract_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">subtract_mean</span></code> option will introduce a small underestimation of variance and other
correlation function values due to a bias on the square of the sample mean.  This bias reduces
as the input image becomes larger, and in the limit of uncorrelated noise tends to the constant
term <code class="docutils literal notranslate"><span class="pre">variance/N**2</span></code> for an N x N sized <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<p>It is therefore recommended that a background/sky subtraction is applied to the <code class="docutils literal notranslate"><span class="pre">image</span></code> before
it is given as an input to the <a class="reference internal" href="#galsim.CorrelatedNoise" title="galsim.CorrelatedNoise"><code class="xref any py py-class docutils literal notranslate"><span class="pre">CorrelatedNoise</span></code></a>, allowing the default <code class="docutils literal notranslate"><span class="pre">subtract_mean=False</span></code>.
If such a background model is global or based on large regions on sky then assuming that the
image has a zero population mean will be reasonable, and won’t introduce a bias in covariances
from an imperfectly-estimated sample mean subtraction.  If this is not possible, just be aware
that <code class="docutils literal notranslate"><span class="pre">subtract_mean=True</span></code> will bias the correlation function low to some level.</p>
<p>You may also specify a gsparams argument.  See the docstring for GSParams using
help(galsim.GSParams) for more information about this option.</p>
<p>Methods:</p>
<p>The main way that a CorrelatedNoise is used is to add correlated noise to an image.
The syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">cn</span><span class="p">)</span>
</pre></div>
</div>
<p>is preferred, although:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span><span class="o">.</span><span class="n">applyTo</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>is equivalent.  See the addNoise() method docstring for more information.  The <code class="docutils literal notranslate"><span class="pre">image.scale</span></code>
is used to get the pixel scale of the input image unless this is &lt;= 0, in which case a scale
of 1 is assumed.</p>
<p>A number of methods familiar from GSObject instances have also been implemented directly as
<code class="docutils literal notranslate"><span class="pre">cn</span></code> methods, so that the following commands are all legal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">shear</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">theta</span> <span class="o">*</span> <span class="n">galsim</span><span class="o">.</span><span class="n">degrees</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dudx</span><span class="p">,</span> <span class="n">dudy</span><span class="p">,</span> <span class="n">dvdx</span><span class="p">,</span> <span class="n">dvdy</span><span class="p">)</span>
</pre></div>
</div>
<p>See the individual method docstrings for more details.  The shift() method is not available
since a correlation function must always be centred and peaked at the origin.</p>
<p>The methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">getVariance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn1</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">withVariance</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn2</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">withScaledVariance</span><span class="p">(</span><span class="n">variance_ratio</span><span class="p">)</span>
</pre></div>
</div>
<p>can be used to get and set the point variance of the correlated noise, equivalent to the zero
separation distance correlation function value.
The <a class="reference internal" href="#galsim.correlatednoise._BaseCorrelatedNoise.withVariance" title="galsim.correlatednoise._BaseCorrelatedNoise.withVariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">galsim.correlatednoise._BaseCorrelatedNoise.withVariance()</span></code></a> method scales
the whole internal correlation function so that its point variance matches <code class="docutils literal notranslate"><span class="pre">variance</span></code>.
Similarly, <a class="reference internal" href="#galsim.correlatednoise._BaseCorrelatedNoise.withScaledVariance" title="galsim.correlatednoise._BaseCorrelatedNoise.withScaledVariance"><code class="xref py py-meth docutils literal notranslate"><span class="pre">galsim.correlatednoise._BaseCorrelatedNoise.withScaledVariance()</span></code></a>
scales the entire function by the given factor.</p>
<p>Arithmetic Operators:</p>
<p>Addition, multiplication and division operators are defined to work in an intuitive way for
correlation functions.</p>
<p>Addition works simply to add the internally-stored correlation functions, so that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn3</span> <span class="o">=</span> <span class="n">cn2</span> <span class="o">+</span> <span class="n">cn1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn4</span> <span class="o">+=</span> <span class="n">cn5</span>
</pre></div>
</div>
<p>provides a representation of the correlation function of two linearly summed fields represented
by the individual correlation function operands.</p>
<p>What happens to the internally stored random number generators in the examples above?  For all
addition operations it is the BaseDeviate belonging to the instance on the Left-Hand Side
of the operator that is retained.</p>
<p>In the example above therefore, it is the random number generator from <code class="docutils literal notranslate"><span class="pre">cn2</span></code> that will be stored
and used by <code class="docutils literal notranslate"><span class="pre">cn3</span></code>, and <code class="docutils literal notranslate"><span class="pre">cn4</span></code> will retain its random number generator after in-place addition of
<code class="docutils literal notranslate"><span class="pre">cn5</span></code>.  The random number generator of <code class="docutils literal notranslate"><span class="pre">cn5</span></code> is not affected by the operation.</p>
<p>The multiplication and division operators, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cn1</span> <span class="o">/=</span> <span class="mf">3.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cn2</span> <span class="o">=</span> <span class="n">cn1</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
<p>scale the overall correlation function by a scalar operand.  The random number generators are
not affected by these scaling operations.</p>
</dd></dl>

<dl class="class">
<dt id="galsim.UncorrelatedNoise">
<em class="property">class </em><code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">UncorrelatedNoise</code><span class="sig-paren">(</span><em class="sig-param">variance</em>, <em class="sig-param">rng=None</em>, <em class="sig-param">scale=None</em>, <em class="sig-param">wcs=None</em>, <em class="sig-param">gsparams=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#UncorrelatedNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.UncorrelatedNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that represents 2D correlated noise fields that are actually (at least initially)
uncorrelated.  Subsequent applications of things like shear or convolvedWith will induce
correlations.</p>
<p>The noise is characterized by a variance in each image pixel and a pixel size and shape.
The <code class="docutils literal notranslate"><span class="pre">variance</span></code> value refers to the noise variance in each pixel.  If the pixels are square
(the usual case), you can specify the size using the <code class="docutils literal notranslate"><span class="pre">scale</span></code> parameter.  If not, they
are effectively specified using the local wcs function that defines the pixel shape.  i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world_pix</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">toWorld</span><span class="p">(</span><span class="n">Pixel</span><span class="p">(</span><span class="mf">1.</span><span class="p">))</span>
</pre></div>
</div>
<p>should return the pixel profile in world coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variance</strong> – The noise variance value to model as being uniform and uncorrelated
over the whole image.</p></li>
<li><p><strong>rng</strong> – If provided, a random number generator to use as the random number
generator of the resulting noise object. (may be any kind of
BaseDeviate object) [default: None, in which case, one will be
automatically created, using the time as a seed.]</p></li>
<li><p><strong>scale</strong> – If provided, use this as the pixel scale.  [default: 1.0, unless <code class="docutils literal notranslate"><span class="pre">wcs</span></code> is
provided]</p></li>
<li><p><strong>wcs</strong> – If provided, use this as the wcs for the image.  At most one of <code class="docutils literal notranslate"><span class="pre">scale</span></code>
or <code class="docutils literal notranslate"><span class="pre">wcs</span></code> may be provided. [default: None]</p></li>
<li><p><strong>gsparams</strong> – An optional GSParams argument.  See the docstring for GSParams for
details. [default: None]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="galsim.getCOSMOSNoise">
<code class="sig-prename descclassname">galsim.</code><code class="sig-name descname">getCOSMOSNoise</code><span class="sig-paren">(</span><em class="sig-param">file_name=None</em>, <em class="sig-param">rng=None</em>, <em class="sig-param">cosmos_scale=0.03</em>, <em class="sig-param">variance=0.0</em>, <em class="sig-param">x_interpolant=None</em>, <em class="sig-param">gsparams=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/galsim/correlatednoise.html#getCOSMOSNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#galsim.getCOSMOSNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a representation of correlated noise in the HST COSMOS F814W unrotated science coadd
images.</p>
<p>See <a class="reference external" href="http://cosmos.astro.caltech.edu/astronomer/hst.html">http://cosmos.astro.caltech.edu/astronomer/hst.html</a> for information about the COSMOS survey,
and Leauthaud et al (2007) for detailed information about the unrotated F814W coadds used for
weak lensing science.</p>
<p>This function uses a stacked estimate of the correlation function in COSMOS noise fields.
The correlation function was computed by the GalSim team as described in</p>
<blockquote>
<div><p>/YOUR/REPO/PATH/GalSim/devel/external/hst/make_cosmos_cfimage.py</p>
</div></blockquote>
<p>and the resulting file is distributed with GalSim as</p>
<blockquote>
<div><p>/YOUR/REPO/PATH/GalSim/share/acs_I_unrot_sci_20_cf.fits</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> – If provided, override the usual location of the file with the given
file name.  [default: None]</p></li>
<li><p><strong>rng</strong> – If provided, a random number generator to use as the random number
generator of the resulting noise object. (may be any kind of
BaseDeviate object) [default: None, in which case, one will be
automatically created, using the time as a seed.]</p></li>
<li><p><strong>cosmos_scale</strong> – COSMOS ACS F814W coadd image pixel scale in the units you are using to
describe GSObjects and image scales in GalSim. [default: 0.03 (arcsec),
see below for more information.]</p></li>
<li><p><strong>variance</strong> – Scales the correlation function so that its point variance, equivalent
to its value at zero separation distance, matches this value.
[default: 0., which means to use the variance in the original COSMOS
noise fields.]</p></li>
<li><p><strong>x_interpolant</strong> – Forces use of a non-default interpolant for interpolation of the
internal lookup table in real space.  See below for more details.
[default: galsim.Linear(tol=1.e-4)]</p></li>
<li><p><strong>gsparams</strong> – An optional GSParams argument.  See the docstring for GSParams for
details. [default: None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a _BaseCorrelatedNoise instance representing correlated noise in F814W COSMOS images.</p>
</dd>
</dl>
<p>The default <code class="docutils literal notranslate"><span class="pre">x_interpolant</span></code> is a <code class="docutils literal notranslate"><span class="pre">galsim.Linear(tol=1.e-4)</span></code>, which uses bilinear interpolation.
The use of this interpolant is an approximation that gives good empirical results without
requiring internal convolution of the correlation function profile by a Pixel object when
applying correlated noise to images: such an internal convolution has been found to be
computationally costly in practice, requiring the Fourier transform of very large arrays.</p>
<p>The use of the bilinear interpolants means that the representation of correlated noise will be
noticeably inaccurate in at least the following two regimes:</p>
<blockquote>
<div><ol class="lowerroman simple">
<li><p>If the pixel scale of the desired final output (e.g. the target image of drawImage(),
applyTo() or whitenImage()) is small relative to the separation between pixels
in the <code class="docutils literal notranslate"><span class="pre">image</span></code> used to instantiate <code class="docutils literal notranslate"><span class="pre">cn</span></code> as shown above.</p></li>
<li><p>If the CorrelatedNoise instance <code class="docutils literal notranslate"><span class="pre">cn</span></code> was instantiated with an image of scale comparable
to that in the final output, and <code class="docutils literal notranslate"><span class="pre">cn</span></code> has been rotated or otherwise transformed (e.g.
via the rotate(), shear() methods, see below).</p></li>
</ol>
</div></blockquote>
<p>Conversely, the approximation will work best in the case where the correlated noise used to
instantiate the <code class="docutils literal notranslate"><span class="pre">cn</span></code> is taken from an input image for which <code class="docutils literal notranslate"><span class="pre">image.scale</span></code> is smaller than that
in the desired output.  This is the most common use case in the practical treatment of
correlated noise when simulating galaxies from COSMOS, for which this function is expressly
designed.</p>
<p>Changing from the default bilinear interpolant is made possible, but not recommended.  For more
information please see the discussion on <a class="reference external" href="https://github.com/GalSim-developers/GalSim/pull/452">https://github.com/GalSim-developers/GalSim/pull/452</a>.</p>
<p>You may also specify a gsparams argument.  See the docstring for GSParams using
help(galsim.GSParams) for more information about this option.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ACS coadd images in COSMOS have a pixel scale of 0.03 arcsec, and so the pixel scale
<code class="docutils literal notranslate"><span class="pre">cosmos_scale</span></code> adopted in the representation of of the correlation function takes a
default value <code class="docutils literal notranslate"><span class="pre">cosmos_scale</span> <span class="pre">=</span> <span class="pre">0.03</span></code></p>
<p>If you wish to use other units, ensure that the input keyword <code class="docutils literal notranslate"><span class="pre">cosmos_scale</span></code> takes the
value corresponding to 0.03 arcsec in your chosen system.</p>
</div>
<p>Example:</p>
<p>The following commands use this function to generate a 300 pixel x 300 pixel image of noise with
HST COSMOS correlation properties (substitute in your own file and path for the <code class="docutils literal notranslate"><span class="pre">filestring</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">BaseDeviate</span><span class="p">(</span><span class="mi">123456</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">getCOSMOSNoise</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">ImageD</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">cf</span><span class="p">)</span>
</pre></div>
</div>
<p>If your image has some other pixel scale or a complicated WCS, then the applied noise will
have the correct correlations in world coordinates, which may not be what you wanted if you
expected the pixel-to-pixel correlations to match the COSMOS noise profile.  However, in
this case, you would want to view your image with the COSMOS pixel scale when you apply
the noise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">wcs</span><span class="o">=</span><span class="n">complicated_wcs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noise</span> <span class="o">=</span> <span class="n">galsim</span><span class="o">.</span><span class="n">getCOSMOSNoise</span><span class="p">(</span><span class="n">rng</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">wcs</span><span class="o">=</span><span class="n">noise</span><span class="o">.</span><span class="n">wcs</span><span class="p">)</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
</pre></div>
</div>
<p>The FITS file <code class="docutils literal notranslate"><span class="pre">out.fits</span></code> should then contain an image of randomly-generated, COSMOS-like noise.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chromatic.html" class="btn btn-neutral float-right" title="Wavelength-dependent Profiles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wcs.html" class="btn btn-neutral float-left" title="World Coordinate Systems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, GalSim-developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>